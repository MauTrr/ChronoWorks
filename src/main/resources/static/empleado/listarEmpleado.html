<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lista Empleados</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="../../css/listaempleados.css" />
    <link rel="stylesheet" href="../../css/header.css" />
    <script src="https://kit.fontawesome.com/8eb65f8551.js" crossorigin="anonymous"></script>
</head>

<body class="fondo">
<header>
    <div class="fondo_menu">
        <div class="container-fluid">
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <div class="container-fluid">
                    <a class="navbar-brand"><img src="../../img/logo.png" alt="Logo" style="width:50px;" class="rounded-pill border border-2" /></a>
                    <a class="navbar-brand fw-semibold text-light">Chronoworks</a>
                    <a href="../../admin.html" class="botoninicio me-2">Inicio</a>
                    <a href="../../logout.html" class="botonsesion">Cerrar Sesión</a>
                </div>
            </nav>
        </div>
    </div>
</header>

<div class="container mt-3 border border-2 p-3" style="border-radius: 15px; max-width: 50%; background: linear-gradient(180deg,rgb(185, 178, 178) 70%, #878c8d 100%);">
    <div class="row">
        <div class="col-md-6 text-center">
            <h3 class="py-2 px-4 mx-auto shadow-sm" style="background: linear-gradient(180deg, #4caed4 0%, #5d8ea1 100%);color: black; max-width: 300px; border-radius: 15px; border: 2px solid white;">Agregar Empleado</h3>
            <a href="agregarempleados.html" class="btn btn-primary mt-2">Agregar</a>
        </div>
        <div class="col-md-6 text-center">
            <h3 class="py-2 px-4 mx-auto shadow-sm" style="background: linear-gradient(180deg, #4caed4 0%, #5d8ea1 100%);color: black; max-width: 300px; border-radius: 15px; border: 2px solid white;">Generar Reporte</h3>
            <a href="#" class="btn btn-secondary mt-2">Generar</a>
        </div>
    </div>
</div>

<h2 class="text-center py-3 px-4 mx-auto mt-4 shadow-sm"
    style="background-color:rgb(185, 178, 178); color: black; max-width: 400px; border-radius: 15px; border: solid 2px white;">
    Lista de Empleados
</h2>

<div class="container mt-3">
    <div class="estilo-tabla table-responsive">
        <table class="table table-bordered table-hover table-striped align-middle text-center">
            <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Apellido</th>
                <th>Correo</th>
                <th>Fecha Ingreso</th>
                <th>Teléfono</th>
                <th>Turno</th>
                <th>Acciones</th>
            </tr>
            </thead>
            <tbody id="tablaEmpleados"></tbody>
        </table>
    </div>
</div>

<script>
    const tabla = document.getElementById("tablaEmpleados");

    function cargarEmpleados() {
      fetch("http://localhost:8080/api/empleados")
        .then(res => res.json())
        .then(data => {
          tabla.innerHTML = "";
          data.forEach(empleado => {
            tabla.innerHTML += `
              <tr>
                <td>${empleado.idEmpleado}</td>
                <td>${empleado.nombre}</td>
                <td>${empleado.apellido}</td>
                <td>${empleado.correo}</td>
                <td>${empleado.fechaIngreso}</td>
                <td>${empleado.telefono}</td>
                <td>${empleado.idTurno}</td>
                <td>
                  <a href="modificarempleados.html?id=${empleado.idEmpleado}" class="btn btn-warning btn-sm me-2">
                    <i class="fa-solid fa-pen-to-square"></i>
                  </a>
                  <button onclick="eliminarEmpleado(${empleado.idEmpleado})" class="btn btn-danger btn-sm">
                    <i class="fa-solid fa-trash"></i>
                  </button>
                </td>
              </tr>`;
          });
        })
        .catch(error => {
          console.error("Error al cargar empleados:", error);
        });
    }

    function eliminarEmpleado(id) {
      if (confirm("¿Desea eliminar el empleado?")) {
        fetch(`http://localhost:8080/api/empleados/${id}`, {
          method: "DELETE"
        })
          .then(response => {
            if (response.ok) {
              alert("Empleado eliminado");
              cargarEmpleados();
            } else {
              alert("Error al eliminar empleado");
            }
          })
          .catch(error => {
            console.error("Error al eliminar:", error);
          });
      }
    }

    window.onload = cargarEmpleados;
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
